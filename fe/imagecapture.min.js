!function(e,t){"function"==typeof define&&define.amd?define(["exports"],t):"undefined"!=typeof exports?t(exports):(t(t={}),e.imagecapture=t)}(this,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};
/**
   * MediaStream ImageCapture polyfill
   *
   * @license
   * Copyright 2018 Google Inc.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *      http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=e.ImageCapture=window.ImageCapture;function a(e){var t=this;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");if("video"!==e.kind)throw new DOMException("NotSupportedError");this._videoStreamTrack=e,"readyState"in this._videoStreamTrack||(this._videoStreamTrack.readyState="live"),this._previewStream=new MediaStream([e]),this.videoElement=document.createElement("video"),this.videoElementPlaying=new Promise(function(e){t.videoElement.addEventListener("playing",e)}),HTMLMediaElement?this.videoElement.srcObject=this._previewStream:this.videoElement.src=URL.createObjectURL(this._previewStream),this.videoElement.muted=!0,this.videoElement.setAttribute("playsinline",""),this.videoElement.play(),this.canvasElement=document.createElement("canvas"),this.canvas2dContext=this.canvasElement.getContext("2d")}void 0===n&&(e.ImageCapture=(t(a,[{key:"getPhotoCapabilities",value:function(){return new Promise(function(e,t){var n={current:0,min:0,max:0};e({exposureCompensation:n,exposureMode:"none",fillLightMode:"none",focusMode:"none",imageHeight:n,imageWidth:n,iso:n,redEyeReduction:!1,whiteBalanceMode:"none",zoom:n}),t(new DOMException("OperationError"))})}},{key:"setOptions",value:function(){return new Promise(function(e,t){})}},{key:"takePhoto",value:function(){var n=this;return new Promise(function(e,t){if("live"!==n._videoStreamTrack.readyState)return t(new DOMException("InvalidStateError"));n.videoElementPlaying.then(function(){try{n.canvasElement.width=n.videoElement.videoWidth,n.canvasElement.height=n.videoElement.videoHeight,n.canvas2dContext.drawImage(n.videoElement,0,0),n.canvasElement.toBlob(e)}catch(e){t(new DOMException("UnknownError"))}})})}},{key:"grabFrame",value:function(){var n=this;return new Promise(function(e,t){if("live"!==n._videoStreamTrack.readyState)return t(new DOMException("InvalidStateError"));n.videoElementPlaying.then(function(){try{n.canvasElement.width=n.videoElement.videoWidth,n.canvasElement.height=n.videoElement.videoHeight,n.canvas2dContext.drawImage(n.videoElement,0,0),e(window.createImageBitmap(n.canvasElement))}catch(e){t(new DOMException("UnknownError"))}})})}},{key:"videoStreamTrack",get:function(){return this._videoStreamTrack}}]),n=a)),window.ImageCapture=n});